# Chapter 01-1. 네트워크 프로그래밍과 소켓의 이해

## 네트워크 프로그래밍과 소켓에 대한 이해

### 네트워크 프로그래밍이란?
* 소켓이라는 것을 기반으로 프로그래밍을 하기 때문에 소켓 프로그래밍이라고도 함.
* 네트워크로 연결된 둘 이상의 컴퓨터 사이에서의 데이터 송수신 프로그램의 작성을 의미함.

### 소켓에 대한 간단한 이해
* 네트워크(인터넷)의 연결 도구
* 운영체제에 의해 제공이 되는 소프트웨어적인 장치
* 소켓은 프로그래머에데 데이터 송수신에 대한 물리적, 소프트웨어적 세세한 내용을 신경 쓰지 않게 한다.

### 전화 받는 소켓의 생성
* 소켓의 비유와 분류
    * TCP 소켓은 전화기에 비유될 수 있다.
    * 소켓은 socket 함수의 호출을 통해서 생성한다.
    * 단 전화를 거는 용도의 소켓과 전화를 수신하는 용도의 소켓 생성 방법에는 차이가 있다.

```c
#include<sys/socket.h>
int socket(int domain, int type, int protocol);

->성공 시 파일 디스크립터, 실패 시 -1 반환
소켓의 생성은 전화기의 장만에 비유 할 수 있다.
```

### 전화번호의 부여
* 소켓의 주소 할당 및 연결
    * 전화기에 전화번호가 부여되듯이 소켓에도 주소정보가 할당된다.
    * 소켓의 주소정보는 IP와 PORT번호로 구성이 된다.

    ```c
    //주소의 할당
    #include<sys/socket.h>
    int bind(int sockfd, struct sockaddr *myaddr, socklen_t addrlen);
    //->성공시 0, 실패시 -1 반환.
    ```

### 전화기의 연결
* 연결 요청이 가능한 상태의 소켓
    * 연결요청이 가능한 상태의 소켓은 걸려오는 전화를 받을 수 있는 상태에 비유할 수 있다.
    * 전화를 거는 용도의 소켓은 연결요청이 가능한 상태의 소켓이 될 필요가 없다. 이는 걸려오는 전화를 받는 용토의 소켓에서 필요한 상태이다.

    ```c
    #include<sys/socket.h>
    int listen(int sockfd, int backlog);
    //성공 시 0, 실패 시 -1 반환.
    ```
    * 소켓에 할당된 ip와 port번호로 연결요청이 가능한 상태가 된다.

### 수화기를 드는 상황

* 연결 요청의 수락
    * 걸려오는 전화에 대해서 수락의 의미로 수화기를 드는 것에 비유할 수 있다.
    * 연결요청이 수락되엉야 데이터의 송수신이 가능하다.
    * 수락된 이후에 데이터의 송수신은 양방향으로 가능하다.

    ```c
    #include<sys/socket.h>
    int accept(int sockfd, struct sockaddr *addr, socklen_t *addlen);
    //성공 시 파일 디스크럽터, 실패시 -1 반환.

    ```
    * accept 함수 호풀 이후에는 데이터의 송수신이 가능하다. 단, 연결요청이 있을 때에만 accept 함수가 반환을 한다.

## 정리하기

### 연결요청을 허용하는 소켓의 생성과정

1. 소켓의 생성 socket 함수호출
2. ip와 port 번호의 할당 bind 함수 호출
3. 연결요청 가능상태로 변경 listen 함수 호출
4. 연결 요청에 대한 수락 accept 함수 호출

---
## 전화 거는 소켓의 구현

### 연결을 요청하는 소켓의 구현
* 전화를 거는 상황에 비유할 수 있다.
* 리스닝 소켓과 달리 구현의 과정이 매우 간단하다.
* '소켓의 생성'과 '연결의 요청'으로 구분된다.

연결의 요청
```c
#include<sys/socket.h>
int connect(int sockfd, struct sockaddr *serv_addr, socklen_t addlen);
//성공 시 0, 실패 시 -1 반환.
```

### 리눅스 기반에서의 실행방법

* 컴파일 방법
```bash
~$ gcc hello_server.c -o hserver
````
hello_server.c 파일을 컴파일해서 hserver라는 이름의 실행파일을 만드는 문장이다.

* 실행방법
```bash
./server
```
현재 디렉터리에 있는 hserver라는 이름의 파일을 실행시키라는 의미이다.
